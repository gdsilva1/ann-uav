\section{Neural Network for \gls*{uav} Control}

\subsection{Data Generation}

Since the script of \citet{geronel2023} provides the control torque \(\symbfup{\tau}_{\eta}\) as input and the state-space \(\symbf{x}_s\) as output vector through dynamic and control equations, the \gls*{nn} goal developed is to go in the opposite direction: take \(\symbf{x}_s\) as the input vector and predict the \(\symbfup{\tau}_{\eta}\) vector as output.

The modifications in the script are minimal.
The time is a discrete vector with \SI{200}{s} and step 0.01, therefore the time vector has \(1\times 20001\) dimension.
The ``extra'' value of time is the zero value.

The output vector \(\tau_{\eta}\) has \(20001\times 4\) dimension the and the input vector \(\symbf{x}_s\) has  \(20001\times 12\) dimension.
%
\begin{equation}\label{eq:tau_input}
    \symbfup{\tau}_{\eta} = \begin{bmatrix}
        a_{1,1}      & a_{1,2}      & a_{1,3}      & a_{1,4} \\
        \vdots       & \vdots       & \vdots       & \vdots  \\
        a_{20001, 1} & a_{20001, 2} & a_{20001, 3} & a_{20001, 4} 
    \end{bmatrix}
\end{equation}
%
where the matrix column represents the control torques \(U_i\) (\(i=1,2,3,4\)).
%
\begin{equation}\label{eq:xs_output}
    \symbf{x}_s = \begin{bmatrix}
        b_{1,1}      & \cdots & b_{1,12} \\
        \vdots       & \ddots & \vdots \\
        b_{20001, 1} & \cdots & b_{20001, 12} 
    \end{bmatrix}
\end{equation}
%
where each column represents the elements of the vector in the~\cref{eq:xs_vector_matlab}.

This way, the circular trajectory was arbitrary selected. They were generated by a loop, changing the position increasing 1/600  for each loop.
It was generated 1000 different trajectories.
This information is summarized in the~\cref{tab:data_generation_uav}.
%
\begin{table}[!htb]
    \centering
    \caption[Data generation for the \gls*{uav}]{Data generation for the \gls*{uav}.}
    \begin{tblr}{
        row{odd}={white}, 
        row{even}={light_color}
    }
    \toprule
    Parameter & Value           \\
    \midrule
    Trajectory    & Circular    \\
    Increase step & 1/600       \\
    Time          & \SI{200}{s} \\
    Time step     & 0.01        \\
    \bottomrule
    \end{tblr}

    {\footnotesize Source: prepared by the author.}
    \label{tab:data_generation_uav}
\end{table}

From there, it was generated one thousand input and output vector.
Both were stored in a \matlab variable and exported through the \texttt{.mat} extension to be used with TensorFlow inside a Python environment.

\subsection{Modeling the Neural Network with TensorFlow}

The problem was considered as a regression problem due its nature, as the~\cref{eq:function_training_model_uav} shows. Note that the input and output are all vector.
%
\begin{equation}\label{eq:function_training_model_uav}
    f\big(\symbf{p}_1(t),\symbf{p}_2(t),\ldots,\symbf{p}_{12}(t)\big) = \langle \symbf{u}_1(t),\symbf{u}_2(t),\symbf{u}_3(t),\symbf{u}_4(t) \rangle
\end{equation}
% \begin{equation}\label{eq:function_training_model_uav}
%     f(\dot{\symbf{x}},\dot{\symbf{y}},\dot{\symbf{z}}\dot{\symbf{\phi}},\dot{\symbf{\theta}},\dot{\symbf{\psi}},\symbf{x},\symbf{y},\symbf{z},\symbf{\phi},\symbf{\theta},\symbf{\psi}) = \langle \symbf{u}_1(t),\symbf{u}_2(t),\symbf{u}_3(t),\symbf{u}_4(t) \rangle
% \end{equation}

In order to obtain a good model without consuming much computational processing, the model was created using the parameters showed in the~\cref{tab:ann_parameters_uav}.
%
\begin{table}[!htb]
    \centering
    \caption[Modeling parameters]{Modeling parameters.}
    \begin{tblr}{
        row{odd}={white}, 
        row{even}={light_color}
    }
    \toprule
    Parameter                   & Value          \\
    \midrule
    Train sample                & 800            \\
    Test sample                 & 200            \\
    Hidden layers               & 3              \\
    \gls*{ann} per hidden layer & 30             \\
    Loss function               & \gls*{mse}     \\
    Activation functions        & Linear \& ReLU \\
    Optimizer                   & Adam           \\
    Optimizer learning rate     & 0.01           \\
    Epochs                      & 60             \\
    \bottomrule
    \end{tblr}
    
    {\footnotesize Source: prepared by the author.}
    \label{tab:ann_parameters_uav}
\end{table}





