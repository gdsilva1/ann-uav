\section{Neural Network for \gls*{uav} Control}

\subsection{Data Generation}

Since the script of \citet{geronel2023} provides the control torque \(\symbf{\tau}\) as input and the state-space \(\symbf{x}_s\) as output vector through dynamic and control equations, the \gls*{nn} goal developed is to go in the opposite direction, as a inverse function: take \(\symbf{x}_s\) as the input vector and predict the \(\symbfup{\tau}_{\eta}\) vector as output.

Modifications in the script are minimal.
The time is a discrete vector with \SI{200}{s} and step 0.01, therefore the time vector has \(1\times 20001\) dimension.
The ``extra'' value of time is the zero value.

The output vector \(\symbfup{T}\) has \(20001\times 4\) dimension the and the input vector \(\symbfup{X}_s\) has  \(20001\times 12\) dimension:
%
\begin{align}
    \symbfup{T} &= \begin{bmatrix}
        U_1 & U_2 & U_3 & U_4 \\
        \vdots       & \vdots       & \vdots       & \vdots  \\
    \end{bmatrix} 
    \label{eq:tau_input} \\
    \setcounter{MaxMatrixCols}{13}
    \symbfup{X}_s &=
    \begin{bmatrix}
        x&y&z&\phi&\theta&\psi&\dot{x}&\dot{y}&\dot{z}&\dot{\phi}&\dot{\theta}&\dot{\psi} \\
        \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots 
    \end{bmatrix}
    \label{eq:xs_output}
\end{align}

Circular trajectory was arbitrary selected as starting point.
By a loop, it was generated 1000 different trajectories changing the position  by increasing 1/600  for each loop.

This way, it was generated one thousand input and output vector.
Both were stored in a \matlab variable and exported through the \texttt{.mat} extension to be used with TensorFlow inside Python environment.

\subsection{Modeling the Neural Network with TensorFlow}

The problem was considered as a regression problem, as the~\cref{eq:function_training_model_uav} shows. Input and output data are all matrices.
%
\begin{subequations}\label{eq:function_training_model_uav}
    \begin{align}
        &f\big(x,y,\ldots,\dot{\theta},\dot{\psi}\big) = \langle U_1, U_2, U_3, U_4 \rangle \\
        &f(\symbfup{X}_s) = \symbfup{T}
    \end{align}
\end{subequations}

\begin{figure}[!htb]
    \centering
    \caption[Schematic model of the NN for the UAV control.]{Schematic model of the \gls*{nn} for the \gls*{uav} control. The input layer receives every element of the \(\symbf{x}_s\) and returns every element of \(\symbf{\tau}\). There are two hidden layers, each one with 64 neurons.}
    \includesvg{./figures/3review/nn/nn2.svg}

    {\footnotesize Source: prepared by the author.}
\end{figure}